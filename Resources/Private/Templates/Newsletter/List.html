<f:layout name="Backend"/>

<f:section name="content">
	<div class="row">
		<div class="col-md-12">
			<h1>
				<f:translate key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow">
					Newsletter todo
				</f:translate>
			</h1>

			<f:render partial="Misc/FlashMessages" arguments="{_all}"/>


			<f:if condition="{newsletters}">
				<f:then>
					<table class="table table-striped table-condensed">
						<thead>
						<tr>
							<th>#</th>
							<th>
								<f:translate
										key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.table.title">
									title
								</f:translate>
							</th>
							<th>
								<f:translate
										key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.table.description">
									description
								</f:translate>
							</th>
							<th>
								<f:translate
										key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.table.created">
									created
								</f:translate>
							</th>
							<th>
								<f:translate
										key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.table.author">
									author
								</f:translate>
							</th>
							<th>
								<f:translate
										key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.table.children">
									triggers / actions
								</f:translate>
							</th>
							<th></th>
						</tr>
						</thead>
						<tbody>
						<f:for each="{workflows}" as="workflow" iteration="iteration">
							<tr>
								<td>{iteration.cycle}.</td>
								<td>
									<f:if condition="{workflow.enabled}">
										<f:then>
											<i class="fa fa-play color-lux" title="Workflow enabled"></i>
										</f:then>
										<f:else>
											<i class="fa fa-stop color-grey" title="Workflow disabled"></i>
										</f:else>
									</f:if>

									<span title="UID{workflow.uid}">{workflow.title}</span>
								</td>
								<td><span title="{workflow.description}"><f:format.crop maxCharacters="200"
																						append=" ...">{workflow.description}</f:format.crop></span>
								</td>
								<td>
									{f:format.date(date:workflow.crdate,format:'{f:translate(key:\'LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:date\')}')}
								</td>
								<td>
									{workflow.cruserId.username}
									<f:if condition="{workflow.cruserId.name}">({workflow.cruserId.username})</f:if>
								</td>
								<td>
									/
								</td>
								<td>
									<f:link.action action="edit" class="btn btn-primary"
												   arguments="{workflow:workflow}">
										<f:translate
												key="LLL:EXT:luxenterprise/Resources/Private/Language/locallang_db.xlf:module.workflow.list.edit">
											change
										</f:translate>
									</f:link.action>
									<f:if condition="{workflow.enabled}">
										<f:then>
											<f:link.action action="disable" class="btn btn-warning"
														   arguments="{workflow:workflow}">
												<f:translate
														key="LLL:EXT:luxenterprise/Resources/Private/Language/locallang_db.xlf:module.workflow.list.disable">
													disable
												</f:translate>
											</f:link.action>
										</f:then>
										<f:else>
											<f:link.action action="enable" class="btn btn-warning"
														   arguments="{workflow:workflow}">
												<f:translate
														key="LLL:EXT:luxenterprise/Resources/Private/Language/locallang_db.xlf:module.workflow.list.enable">
													enable
												</f:translate>
											</f:link.action>
										</f:else>
									</f:if>

									<f:link.action action="delete" class="btn btn-danger"
												   arguments="{workflow:workflow}" data="{lux-action:'deleteWorkflow'}">
										<f:translate
												key="LLL:EXT:luxenterprise/Resources/Private/Language/locallang_db.xlf:module.workflow.list.delete">
											delete
										</f:translate>
									</f:link.action>
								</td>
							</tr>
						</f:for>
						</tbody>
					</table>
				</f:then>
				<f:else>
					<div class="lux-workflow-new"></div>
					<f:link.action action="new" class="btn btn-lg-extra btn-primary btn-primary-extra">
						<span><f:translate
								key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.list.add2">No newsletters yet (todo)</f:translate></span>
						<f:translate
								key="LLL:EXT:lux/Resources/Private/Language/locallang_db.xlf:module.workflow.list.add3">
							Add a new one (todo)
						</f:translate>
					</f:link.action>
				</f:else>
			</f:if>

		</div>
	</div>
</f:section>
